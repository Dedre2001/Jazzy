# 2.X 机器学习模型比较实验

## 2.X.1 实验设计

### 2.X.1.1 模型选择与配置

为评估不同机器学习算法在水稻抗旱性预测任务中的表现，本研究构建了包含三个层级共六种模型的比较框架（表X-1）。第一层级为农学领域广泛应用的经典方法，包括偏最小二乘回归（PLSR）和支持向量回归（SVR）；第二层级为传统机器学习方法，包括岭回归（Ridge）、随机森林（RF）和梯度提升树（CatBoost）；第三层级为基于Transformer架构的表格数据基础模型TabPFN（Hollmann et al., 2023）。

**表X-1 模型配置参数**

| 层级 | 模型 | 类型 | 关键超参数 |
|:----:|:-----|:-----|:-----------|
| Layer 1 | PLSR | 经典农学方法 | n_components = 5 |
| Layer 1 | SVR | 经典农学方法 | kernel = rbf, C = 1.0 |
| Layer 2 | Ridge | 传统机器学习 | α = 1.0 |
| Layer 2 | RF | 传统机器学习 | n_estimators = 300, max_depth = 5 |
| Layer 2 | CatBoost | 传统机器学习 | iterations = 500, learning_rate = 0.05 |
| Layer 3 | TabPFN | 基础模型 | n_estimators = 256 |

*注：TabPFN为预训练模型，无需针对特定任务进行超参数调优。*

### 2.X.1.2 评价指标体系

鉴于本研究的核心目标为品种抗旱性排序而非精确数值预测，评价指标体系涵盖四个维度：（1）回归精度指标，包括决定系数（R²）、均方根误差（RMSE）和平均绝对误差（MAE）；（2）排序一致性指标，包括Spearman等级相关系数（ρ）和Kendall秩相关系数（τ）；（3）Top-K命中率指标，包括Hit@3、Hit@5和Jaccard@K，用于评估高抗旱性品种的识别能力；（4）分类指标，将品种按D_conv值划分为耐旱（Tolerant, Rank 1-4）、中等（Moderate, Rank 5-8）和敏感（Sensitive, Rank 9-13）三个等级，计算分类准确率和Cohen's Kappa系数。

### 2.X.1.3 交叉验证策略

采用5折分组交叉验证（GroupKFold），以品种为分组单位，确保同一品种的所有样本被划分至同一折内。该策略可有效避免因同品种样本同时出现于训练集和测试集而导致的信息泄露问题。所有实验采用固定随机种子（seed = 42）以保证结果可重复性。

---

## 2.X.2 模型预测性能比较

### 2.X.2.1 综合性能评估

六种模型在水稻抗旱性预测任务中的综合性能如表X-2所示。在回归精度方面，TabPFN取得了最高的决定系数（R² = 0.943）和最低的均方根误差（RMSE = 0.031），其次为PLSR（R² = 0.936, RMSE = 0.033）。SVR的回归精度明显偏低（R² = 0.421），表明其在该数据集上存在欠拟合现象。

**表X-2 模型综合性能比较**

| 模型 | 层级 | R² | RMSE | MAE | Spearman ρ | Kendall τ | Pairwise Acc |
|:-----|:----:|:---:|:----:|:---:|:----------:|:---------:|:------------:|
| TabPFN | Layer 3 | 0.943 | 0.031 | 0.025 | **1.000** | **1.000** | **1.000** |
| PLSR | Layer 1 | **0.936** | 0.033 | 0.027 | 0.978 | 0.897 | 0.949 |
| CatBoost | Layer 2 | 0.867 | 0.048 | 0.040 | 0.978 | 0.923 | 0.962 |
| RF | Layer 2 | 0.851 | 0.051 | 0.042 | 0.967 | 0.897 | 0.949 |
| Ridge | Layer 2 | 0.902 | 0.041 | 0.033 | 0.940 | 0.821 | 0.910 |
| SVR | Layer 1 | 0.421 | 0.100 | 0.084 | 0.940 | 0.821 | 0.910 |

*注：加粗数值表示各指标的最优值。Pairwise Acc为配对比较准确率。*

### 2.X.2.2 排序一致性分析

在排序一致性方面，TabPFN表现出完美的排序能力，Spearman ρ和Kendall τ均达到1.000，表明其预测的品种排序与真实抗旱性排序完全一致。CatBoost和PLSR表现次之，Spearman ρ均为0.978。配对比较准确率（Pairwise Accuracy）反映了模型正确判断任意两个品种相对抗旱性强弱的能力，TabPFN达到100%的配对准确率，而Ridge和SVR仅为91.0%。

### 2.X.2.3 Top-K命中率

在育种实践中，准确识别抗旱性最强的品种具有重要价值。表X-3展示了各模型的Top-K命中率指标。除Ridge外，其余五种模型的Hit@3均达到100%，表明均能正确识别抗旱性排名前三的品种。在Hit@5指标上，SVR降至80%，表明其在Top-5品种识别上存在1个错误。

在三分类任务（耐旱/中等/敏感）中，TabPFN、PLSR、CatBoost和RF的Cohen's Kappa系数均为0.884，达到"几乎完美"的一致性水平。Ridge的Kappa为0.770，属于"较强"一致性。值得注意的是，SVR的Kappa为0.000，表明其分类结果与随机猜测无异，这可能是由于SVR在该数据集上存在欠拟合，导致预测值分布过于集中。

**表X-3 Top-K命中率与分类性能**

| 模型 | Hit@3 | Hit@5 | Kappa |
|:-----|:-----:|:-----:|:-----:|
| TabPFN | 1.00 | 1.00 | 0.884 |
| PLSR | 1.00 | 1.00 | 0.884 |
| CatBoost | 1.00 | 1.00 | 0.884 |
| RF | 1.00 | 1.00 | 0.884 |
| Ridge | 0.67 | 1.00 | 0.770 |
| SVR | 1.00 | 0.80 | 0.000 |

*注：Kappa为Cohen's Kappa系数（三分类：耐旱/中等/敏感）。Kappa = 0表示分类结果与随机猜测无异。*

---

## 2.X.3 品种排名一致性分析

### 2.X.3.1 品种级预测结果

为深入分析各模型在品种层面的预测表现，将13个品种的预测排名与真实排名进行对比（表X-4）。结果显示，TabPFN对所有品种的排名预测与真实排名完全一致。其他模型均存在不同程度的排名偏差，其中品种1214的预测难度较大，Ridge将其排名从第5位误判至第2位，偏差达3个位次。

**表X-4 品种排名对比**

| 品种 | 抗旱等级 | 真实排名 | TabPFN | CatBoost | RF | PLSR | Ridge | SVR |
|:----:|:--------:|:--------:|:------:|:--------:|:--:|:----:|:-----:|:---:|
| 1252 | Tolerant | 1 | 1 | 1 | 1 | 1 | 1 | 2 |
| 1257 | Tolerant | 2 | 2 | 2 | 2 | 3 | 3 | 3 |
| 1099 | Tolerant | 3 | 3 | 3 | 3 | 2 | 4 | 1 |
| 1228 | Tolerant | 4 | 4 | 4 | 4 | 5 | 5 | 4 |
| 1214 | Moderate | 5 | 5 | 5 | 5 | 4 | 2 | 8 |
| 1274 | Moderate | 6 | 6 | 7 | 7 | 7 | 7 | 6 |
| 1210 | Moderate | 7 | 7 | 6 | 6 | 6 | 6 | 5 |
| 73 | Moderate | 8 | 8 | 8 | 8 | 8 | 8 | 7 |
| 12 | Sensitive | 9 | 9 | 10 | 10 | 9 | 10 | 9 |
| 1219 | Sensitive | 10 | 10 | 11 | 12 | 11 | 11 | 10 |
| 1110 | Sensitive | 11 | 11 | 9 | 9 | 10 | 9 | 11 |
| 1218 | Sensitive | 12 | 12 | 12 | 11 | 12 | 13 | 13 |
| 1235 | Sensitive | 13 | 13 | 13 | 13 | 13 | 12 | 12 |

*注：抗旱等级根据D_conv值划分：Tolerant (Rank 1-4), Moderate (Rank 5-8), Sensitive (Rank 9-13)。*

### 2.X.3.2 排名偏差分析

各品种的平均排名偏差分析揭示了预测难度的差异（图X-1）。品种1110和1214的平均排名偏差最大（1.17个位次），表明这两个品种的抗旱性特征可能与其他品种存在重叠，导致模型难以准确定位。相反，品种1235、73和1252的平均排名偏差最小（分别为0.33、0.17和0.17个位次），所有模型均能准确预测这些品种的相对抗旱性。

值得注意的是，排名偏差较大的品种多位于抗旱等级的边界区域（如Moderate与Sensitive的交界处），这一现象符合生物学预期，因为边界品种的表型特征往往介于两个等级之间，难以明确区分。

---

## 2.X.4 统计显著性检验

### 2.X.4.1 Friedman检验

为评估六种模型间的性能差异是否具有统计显著性，采用Friedman检验（Friedman, 1937）对各品种上的模型排名进行分析。以各模型在每个品种上的预测绝对误差进行排名（误差越小排名越前），构建13×6的排名矩阵。

Friedman检验结果显示，χ² = 26.93，*p* = 5.9 × 10⁻⁵，表明六种模型在预测性能上存在显著差异。

### 2.X.4.2 效应量分析

鉴于样本量较小（*n* = 13个品种），仅依赖*p*值可能导致对结果的过度解读。因此，本研究采用Kendall's W协和系数（Kendall & Smith, 1939）作为效应量指标，评估各品种对模型排名的一致程度。

计算得Kendall's W = 0.414，根据效应量解释标准（Landis & Koch, 1977），该值表示中等程度的一致性（moderate agreement）。这一结果表明：（1）模型间确实存在性能差异，但并非在所有品种上均表现一致；（2）某些品种可能对特定模型更为"友好"，而另一些品种则具有更广泛的预测难度。

### 2.X.4.3 平均排名与置信区间

各模型的平均排名及95% Bootstrap置信区间如表X-5所示。TabPFN的平均排名最低（2.00，95% CI: [1.46, 2.54]），表明其在多数品种上的预测误差最小。SVR的平均排名最高（5.46，95% CI: [4.85, 5.92]），与其他模型存在显著差距。

**表X-5 模型平均排名与统计检验结果**

| 模型 | 平均排名 | 95% CI | 与TabPFN的排名差 |
|:-----|:--------:|:------:|:----------------:|
| TabPFN | 2.00 | [1.46, 2.54] | — |
| PLSR | 2.69 | [1.92, 3.54] | 0.69 |
| Ridge | 3.08 | [2.31, 3.92] | 1.08 |
| RF | 3.77 | [2.92, 4.46] | 1.77 |
| CatBoost | 4.00 | [3.54, 4.54] | 2.00 |
| SVR | 5.46 | [4.85, 5.92] | 3.46 |

*注：Friedman χ² = 26.93, p = 5.9 × 10⁻⁵; Kendall's W = 0.414 (中等效应量); Nemenyi CD = 2.09。*

### 2.X.4.4 Nemenyi事后检验

采用Nemenyi事后检验确定模型间的显著性差异。在α = 0.05水平下，临界距离CD = 2.09。平均排名差异超过CD的模型对之间存在显著差异（图X-2）。

结果显示：
- TabPFN与SVR之间存在显著差异（排名差 = 3.46 > CD = 2.09）
- TabPFN与CatBoost之间存在显著差异（排名差 = 2.00 ≈ CD）
- TabPFN、PLSR与Ridge之间无显著差异（排名差 < CD）

---

## 2.X.5 小结

本节通过系统的模型比较实验，评估了六种机器学习算法在水稻抗旱性预测任务中的表现。主要发现如下：

（1）**TabPFN表现最优**：在排序一致性指标上，TabPFN达到了完美的Spearman ρ = 1.000和Kendall τ = 1.000，显著优于传统机器学习方法。作为预训练的表格数据基础模型，TabPFN无需针对特定任务进行超参数调优，具有较高的实用价值。

（2）**Top-K命中率满足育种需求**：除Ridge和SVR外，其余四种模型的Hit@3均达到100%，表明基于多源光谱融合特征的机器学习方法能够可靠地识别高抗旱性品种，满足育种初筛的实际需求。

（3）**模型间存在显著差异**：Friedman检验证实了模型间的性能差异（*p* = 5.9 × 10⁻⁵），Kendall's W = 0.414表明效应量为中等程度。Nemenyi事后检验显示TabPFN与SVR之间存在显著差异。

（4）**边界品种预测难度较大**：位于抗旱等级边界的品种（如1214、1110）具有较高的排名偏差，这与其表型特征的边界性质一致，提示在实际应用中应对边界品种的分类结果保持审慎。

---

## 参考文献

Friedman, M. (1937). The use of ranks to avoid the assumption of normality implicit in the analysis of variance. *Journal of the American Statistical Association*, 32(200), 675-701.

Hollmann, N., Müller, S., Eggensperger, K., & Hutter, F. (2023). TabPFN: A transformer that solves small tabular classification problems in a second. *International Conference on Learning Representations (ICLR)*.

Kendall, M. G., & Smith, B. B. (1939). The problem of m rankings. *The Annals of Mathematical Statistics*, 10(3), 275-287.

Landis, J. R., & Koch, G. G. (1977). The measurement of observer agreement for categorical data. *Biometrics*, 33(1), 159-174.
